<!DOCTYPE html>
<html lang="en" ng-app="app">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{ news.title }}</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular-route.min.js"></script>
  <link rel="stylesheet" href="/css/articles.css">
  <script src="/angular/app.js"></script>
</head>
<body ng-controller="articleController">
    <%- include('partials/header') %>

    <!-- Artikel Konten -->
    <div class="container mt-4">
        <!-- Jika ada artikel, tampilkan -->
        <div ng-if="news">
            <h1>{{ news.title }}</h1>
            <img ng-if="news.image_url" ng-src="{{ news.image_url }}" alt="{{ news.title }}" class="img-fluid mb-3">
            <p>{{ news.full_article }}</p>
        </div>

        <!-- Jika gagal mengambil artikel -->
        <div ng-if="errorMessage" class="alert alert-danger">
            {{ errorMessage }}
        </div>

        <a href="/news" class="btn btn-secondary">Back to News</a>
    </div>      

    <script>
      angular.module('app', ['ngRoute'])  // Menambahkan 'ngRoute' ke dalam array dependensi
      .config(function($routeProvider) {
        $routeProvider
        .when('/news/:id', {  // Menggunakan parameter ':id' untuk artikel
        templateUrl: '/path/to/articles.ejs',  // Path template artikel
        controller: 'articleController'  // Menambahkan controller artikel
        })
        .otherwise({
          redirectTo: '/news'
        });
      });

    </script>

    <!-- Sertakan controller JavaScript -->
    <script>
      angular.module('app')
      .controller('articleController', function($scope, $http, $routeParams) {
        // Mendapatkan ID artikel dari URL
        const articleId = $routeParams.id;  // Mengambil parameter 'id' dari URL
        
        // Mengambil data artikel dari API
        $http.get(`/news/api/news/${articleId}`)
        .then(function(response) {
          $scope.news = response.data;  // Menyimpan data artikel ke scope
          })
          .catch(function(error) {
            console.error('Error loading article:', error);
            $scope.errorMessage = 'Failed to load article'; // Menampilkan pesan error jika gagal
            });
          });
          </script>
</body>
</html>
